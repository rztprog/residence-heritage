<figure class='show-figure'>
  <img src="https://plus.unsplash.com/premium_photo-1674676471417-07f613528a94?q=80&w=1445&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="">
</figure>
<div class="font-(family-name:--inter-font) mt-5 max-w-[1728px] w-full px-6 sm:px-12 lg:px-[120px] xl:px-[140px] mx-auto">
    <h1 class='show-name'><%= @flat.name %></h1>
    <p class='show-title'><%= @flat.title %></p>
    <div class='card-description-wrapper'>
      <p><%= @flat.description %></p>
      <div class='price-card'>
        <p class='text-2xl'><b>€ <%= @flat.rent + @flat.charges %></b> /<span class='text-sm'> mois</span></p>
        <p class='text-sm'>Toutes charges comprises</p>
        <hr>
        <div class='price-card-line'>
          <p>Loyer / mois</p>
          <p><%= @flat.rent %>€</p>
        </div>
        <div class='price-card-line'>
          <p>Charges</p>
          <p><%= @flat.charges %>€</p>
        </div>
        <div class='mt-5 price-card-line font-bold'>
          <p>Total / mois</p>
          <p><%= @flat.rent + @flat.charges %>€</p>
        </div>
        <hr>
        <div class='price-card-line font-bold'>
          <p>Dépôt de garantie</p>
          <p><%= @flat.rent + @flat.charges %>€</p>
        </div>
        <hr>
        <div class='price-card-line font-bold'>
          <p>Éligible aux aides (APL, ALS)</p>
          <p>Oui</p>
        </div>
        <div class='price-card-line font-bold'>
          <p>Chambre disponible</p>
          <p>Oui</p>
        </div>
        <%= link_to root_path, class: "mt-5 inline-block bg-(--blue) text-white font-semibold py-2 px-4 rounded-xl shadow transition duration-150 w-full text-center" do %>
          Je veux rejoindre cette collocation
        <% end %>
      </div>
    </div>
    <h2 class='show-name'>Plongez dans les lieux</h2>
    <p>Ici les photos blabla..</p>
    <h2 class='show-name'>Équipements</h2>
    <div class="">
      <div class="mt-10 mb-10 flex">
        <div class="w-[50%]">
          <h2 class='text-xl'>🛏️ Équipements individuels</h2>
          <p class='mb-10'>Dans chaque chambre</p>
          <ul class='services-list'>
            <li>✅ Internet haut débit (Wifi 6E)</li>
            <li>✅ Abonnements Netflix / Prime (salon & chambres)</li>
            <li>✅ Robot aspirateur / laveur</li>
            <li>✅ Ioniseur d'air</li>
            <li>✅ Ménage hebdomadaire</li>
            <li>✅ Accés sécurisé et alarme connecté</li>
          </ul>
        </div>
        <div class="show-separation-vertical"></div>
        <div class="w-[50%]">
          <h2 class='text-xl'>🛋️ Équipements communs</h2>
          <p class='mb-10'>Pièce de vie & espaces partagés</p>
          <div class="services-list">
            <ul class='services-list'>
              <li>✅ Canapé & espace TV (Connecté)</li>
              <li>✅ Cuisine équipée (plaque, four, micro-ondes, frigo, ustensiles...)</li>
              <li>✅ Lave-linge / sèche-linge</li>
              <li>✅ Table à manger & chaises</li>
              <li>✅ Robot aspirateur / laveur</li>
              <li>✅ Ioniseur d’air</li>
              <li>✅ Service de ménage hebdomadaire</li>
              <li>✅ Accès sécurisé & alarme connecté</li>
              <li>✅ Espaces lumineux et décorés avec soin</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <h2 class='show-name'>Où se trouve l'appartement ?</h2>
    <%= @flat.latitude %>
    <%= @flat.longitude %>
    <div class='mt-10 mb-10'>
      <div id="map" style="height: 600px"></div>
    </div>
    
    <script>
      document.addEventListener('turbo:load', () => {
        // Charger dans le layout mais reload via turbo:load
        mapboxgl.accessToken = "<%= ENV['MAPBOX_KEY'] %>";

        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v12',
            center: [3.161304, 50.700424], 
            zoom: 14
        });


        const marker = new mapboxgl.Marker()
          .setLngLat([3.161304, 50.700424])
          .addTo(map);
          

        map.addControl(new mapboxgl.NavigationControl());
        map.scrollZoom.disable();

      });
    </script>
</div>